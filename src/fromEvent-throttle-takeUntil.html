<!DOCTYPE html>
<html lang="en">
<head>
    <style>
        #box {width: 200px; height:200px; background-color: aquamarine; position : relative; cursor: pointer;}
        #box > div { height:5px;  width : 5px; position: absolute; background-color: darkred;}
    </style>
</head>
<body>

<div id="box" style="">

</div>
<pre id="pre"></pre>

<script src="/bower_components/rxjs/dist/rx.all.js"></script>
<script src="/bower_components/jquery/dist/jquery.min.js"></script>
<script>

    var $boxEl = $('#box');
    var boxEl = $boxEl[0];
    var preEl = $('#pre')[0];


    var stream = Rx.Observable.fromEvent(boxEl, 'mousedown')
        .flatMap(function (m) {
            return Rx.Observable.fromEvent(boxEl, 'mousemove').throttle(200);
        })
        .do(function (evt) {
            var $el = $('<div>').css({
                top : evt.y,
                left : evt.x
            });
            $boxEl.append($el);
        })
        .filter(function (e) {
            return e !== null
        })
        .map(function (e) {
            return 'x'+e.x + '-y' + e.y;
        })
        .do(function (str) {
            preEl.innerText = str  + '\n' + preEl.innerText
        })
        .takeUntil(Rx.Observable.fromEvent(boxEl, 'mouseup')).repeat();


    stream.subscribe(function (val) {
        console.log(val);

    });




</script>

</body>
</html>


